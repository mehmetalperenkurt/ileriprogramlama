
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <title>booking </title>
    </head>
<style>
    .main{
    background-position-x: center;
    background-position-y: center;
    }
</style>
    <body>
            <div class="main" style="align-content: center;margin-top: 5%; margin-left: 5%;"><h2 id=title>flight booking</h2>
                <br>
                <form action="">
                    one way<input type="radio" name="trip" checked id="radyo" onchange="document.getElementById('depart2').disabled=true"> 
                    round trip<input type="radio" name="trip" id="radyo2" onchange="document.getElementById('depart2').disabled=false">
                    
                </form>
                <br>
                <input type="text" id="departLocation" list="departLocationList" placeholder="From" style="width:120px" autocomplete=on required role="combobox" aria-label="Flight origin input" smarty="true" autocomplete="off" autocapitalize="off" autocorrect="off" role="combobox" aria-autocomplete="departLocation" aria-expanded="true">
           <datalist id="departLocationList">
                <option value="İstanbul"></option>
                <option value="İzmir"></option>
                <option value="Ankara"></option>
                <option value="Trabzon"></option>
                <option value="Diyarbakır"></option>
                <option value="Antalya"></option>
                <option value="Muğla"></option>
                <option value="Malatya"></option>
                <option value="Sivas"></option>
                <option value="Gaziantep"></option>
                <option value="Şanlıurfa"></option>
                <option value="Van"></option>
                <option value="Giresun"></option>
                <option value="Samsun"></option>
                <option value="Ordu"></option>
                <option value="Kayseri"></option>
            </datalist>
            <input type="text" list="destinationLocation" placeholder="To" autocomplete="on" style="width: 120px" autocomplete=off required>
            <datalist id="destinationLocation">
                <option value="İstanbul"></option>
                <option value="İzmir"></option>
                <option value="Ankara"></option>
                <option value="Trabzon"></option>
                <option value="Diyarbakır"></option>
                <option value="Antalya"></option>
                <option value="Muğla"></option>
                <option value="Malatya"></option>
                <option value="Sivas"></option>
                <option value="Gaziantep"></option>
                <option value="Şanlıurfa"></option>
                <option value="Van"></option>
                <option value="Giresun"></option>
                <option value="Samsun"></option>
                <option value="Ordu"></option>
                <option value="Kayseri"></option>
            </datalist>

        <input type="date" id="depart" name="trip-start" value="" min="2018-12-09" max="2019-12-12">
        <input type="date" id="depart2" name="trip-start" value="" min="2018-12-09" max="2019-12-12" disabled>
        <input type="button" value="search">
    </div>
        
    <br>
    <p id=out></p>
    </body>

<script>
 /*<template id="resultstemplate">    </template>
 var search = document.querySelector('#departLocation');
    var results = document.querySelector('#departLocationList');
    var templateContent = document.querySelector('#resultstemplate').content;
    search.addEventListener('keyup', function handler(event) {
    while (results.children.length) results.removeChild(results.firstChild);
    var inputVal = new RegExp(search.value.trim(), 'i');
    var clonedOptions = templateContent.cloneNode(true);
    var set = Array.prototype.reduce.call(clonedOptions.children, function searchFilter(frag, el) {
        if (inputVal.test(el.textContent) && frag.children.length < 4) frag.appendChild(el);
        return frag;
    }, document.createDocumentFragment());
    results.appendChild(set);
});*/ 
document.getElementById('depart').valueAsDate = new Date();

class Flights{
constructor(companyName,flightCode,aircraftModel,departLocation,departLocationCode,destinationLocation,destinationLocationCode,flightDates){
        this.companyName=companyName
        this.flightCode=flightCode
        this.aircraftModel=aircraftModel
        this.departLocation=departLocation
        this.departLocationCode=departLocationCode
        this.destinationLocation=destinationLocation 
        this.destinationLocationCode=destinationLocationCode
        this.flightDates=flightDates
        //this.flightTime="";
        //this.durationTime="";
        //this.connection=false; 
        //this.stationLocation=""; 
        //this.passengerList="";
    }
}
class aircraft{
    constructor(){
        this.schema="";
        this.model="";
        this.capacity="";
        this.seats="";
    }
}
class company{
    constructor(){
        this.name="";
        this.fleet="";
        this.logoURL="";
    }
}
class airport{
    constructor(){
        this.airportCode="";
        this.cityName="";
        this.countryName="";
        //this.countryCode="";
        this.gates="";
        //this.flightList="";
    }
}
class passenger{
    constructor(){
        this.passNationalID="";
        this.passName="";
        this.passSurname="";
        this.oldJourney=[];
        this.currentTicket="";
    }
}
class ticket{
    constructor(){
        this.resCode="";
        this.from="";
        this.to="";
        this.gate="";
        this.seat="";
        this.date="";
        this.boardingTime="";
    }
}
class database{
    constructor(){
        this.urlS="https://mehmetalperenkurt.github.io/ileriprogramlama/work/calisma/flights.txt";
        this.passengers=new Map();
        this.flights= new Map();
        this.tickets=new Map();
        this.airports=new Map();
        this.readFlights();
    }
    readFlights(){
        console.log("readFlights "+this.urlS);
        fetch(this.urlS)
        .then(r => r.text())
	    .then(r => this.addFlights(r))     
    }
    addFlights(txt){
        let a = txt.split("\n");
        for (let s of a) {
        let flights = this.parseFlights(s);
        this.flights.set(flights.flightCode,flights);
        }
    }
    parseFlights(line){
        let s = line.split("\t");
        let dates = [];
        for (let i=7; i<s.length; i++) 
        dates.push(s[i]);
        const flight = new Flights(s[0],s[1],s[2],s[3],s[4],s[5],s[6],dates)
        return flight
    }
}
ac=new database();

</script>
</html>
<script>
setInterval(function(){ const out=ac.flights.size; document.getElementById('out').innerHTML=+""+out+" flights found."; }, 3000);

</script>